# WIP

# Encypted directories
source ~/.shellconfig/libs/kv-bash/kv-bash
encryptdir () {
  if [[ $# == 0 ]]; then
    echo "encryptdir dir_name [secretdir_name]"
  # encrypt and add to links
  elif [[ $# == 1 ]]; then
    
  else
    secret=$(readlink -f $1)
    userfacing=$(readlink -f $2)
    encfs $secret $userfacing
    fusermount -u $2
    kvset $secret $userfacing
  fi
}

# if no args
#   echo help
# if one arg and main doesnt exist
#   make the main dir and secret dir
# if one arg and main exists
#   make secret dir
# if two args and main doesnt exist and secret doesnt exist
#   make both

# if no args
#   echo help
# if

opendir () {
  if [[ -e $1 ]]; then
    dir=$(readlink -f $1)
    secret=$(kvget $dir)
    encfs $secret $dir
  else
    echo "Dir not found"
  fi
}

closedir() {
  if [[ -e $1 ]] && [[ -z $(kvget $(readlink -f $1)) ]]; then
    fusermount -u $1
  else
    echo "error"
  fi
}
